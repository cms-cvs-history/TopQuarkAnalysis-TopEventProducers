process TQAF = {
# initialize MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.cerr.threshold = "INFO"
# return filter & timing reports
  untracked PSet options = { untracked bool wantSummary = true }

# input file
  source = PoolSource { 
    untracked vstring fileNames = { 
      'file:/afs/cern.ch/cms/PRS/top/cmssw-data/relval200-for-pat-testing/FullSimTTbar-210p5.1-AODSIM.100.root' 
    } 
  }
  untracked PSet maxEvents = { untracked int32 input = 100 }

#
# tqaf steering
#
  include "TopQuarkAnalysis/TopObjectProducers/data/tqafLayer1_full.cff"
  include "TopQuarkAnalysis/TopEventProducers/data/tqafLayer2_ttSemiLeptonic.cff"

  path p = {
    tqafLayer1,
    tqafLayer2_ttSemiLeptonic
  }

#
# output 
#

# define the event content
  block tqafEventContent = {
    untracked vstring outputCommands = {
      "drop *"
    }
  }
  include "TopQuarkAnalysis/TopEventProducers/data/tqafLayer2_EventContent.cff"
  replace tqafEventContent.outputCommands += tqafLayer2TtSemiLeptonicEventContent.outputCommands
  include "TopQuarkAnalysis/TopObjectProducers/data/tqafLayer1_EventContent.cff"
  replace tqafEventContent.outputCommands += patLayer1EventContent.outputCommands

# to only accept events passing the complete path
  block EventSelection = {
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p" }
    }
  }

# fan out
  module out = PoolOutputModule {
    untracked string fileName = "TQAFLayer2_Output.fromAOD_full.root"
    using EventSelection
    using tqafEventContent
    untracked bool verbose = false
  }

  endpath outpath = { out }
}
